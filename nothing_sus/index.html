<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Hobopad</title>
<style>
    /* Base Styles */
    html, body {
        height: 100%;
        margin: 0;
        padding: 0;
        overflow: hidden;
        font-family: "Tahoma", "Geneva", sans-serif;
        transition: background-color 0.3s;
    }
    
    /* Main App Window */
    #app-window {
        width: 100vw;
        height: 100vh;
        display: flex;
        flex-direction: column;
        box-sizing: border-box;
        overflow: hidden;
        background-color: #c0c0c0;
        border: 3px solid #c0c0c0;
        border-top-color: #ffffff;
        border-left-color: #ffffff;
        border-right-color: #000000;
        border-bottom-color: #000000;
    }
    
    /* Title Bar */
    .title-bar {
        display: flex;
        justify-content: center;
        align-items: center;
        background: linear-gradient(90deg, #000080, #1084d0);
        padding: 3px 5px;
        color: white;
        font-weight: bold;
        height: 20px;
        user-select: none;
        position: relative;
    }
    
    .title-bar-text {
        padding: 0 8px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        text-align: center;
    }
    
    .title-bar-controls {
        position: absolute;
        right: 5px;
        display: flex;
        gap: 3px;
    }
    
    .win-button {
        width: 18px;
        height: 18px;
        min-width: 18px;
        padding: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        font-size: 12px;
        color: black;
        border-radius: 0;
        border: 1px solid;
        border-color: #ffffff #000000 #000000 #ffffff;
        background-color: #c0c0c0;
        cursor: pointer;
    }
    
    .win-button:active {
        border-color: #000000 #ffffff #ffffff #000000;
    }
    
    /* Horizontal Menu Bar - Updated to align right */
    .menu-container {
        display: flex;
        height: 100%;
        align-items: center;
        justify-content: flex-end; /* Changed from flex-start to flex-end */
    }
    
    .menu-bar {
        display: flex;
        flex-direction: row;
        list-style: none;
        margin: 0;
        padding: 0 10px 0 0; /* Changed padding to right only */
        height: 100%;
    }
    
    .menu-item {
        position: relative;
        padding: 0 10px;
        cursor: pointer;
        height: 100%;
        display: flex;
        align-items: center;
        color: white;
        user-select: none;
    }
    
    .menu-item:hover {
        background: rgba(255, 255, 255, 0.2);
    }
    
    .dropdown-content {
        display: none;
        position: absolute;
        top: 100%;
        left: 0;
        background-color: #c0c0c0;
        min-width: 150px;
        box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
        z-index: 1;
        list-style: none;
        padding: 0;
        border: 1px solid #000000;
    }
    
    .dropdown-content li {
        padding: 8px;
        cursor: pointer;
        color: black;
        border-bottom: 1px solid #868a8e;
        text-align: left;
    }
    
    .dropdown-content li:hover {
        background: #000080;
        color: white;
    }
    
    /* Editor Area */
    .window-body {
        display: flex;
        flex-direction: column;
        flex-grow: 1;
        margin: 0;
        padding: 0;
        min-height: 0;
        background: white;
        box-shadow: inset -1px -1px #fff, inset 1px 1px #000, inset -2px -2px #868a8e, inset 2px 2px #dfdfdf;
    }
    
    /* Windows 95/98 Theme - Default */
    #editor {
        flex-grow: 1;
        padding: 10px;
        margin: 2px;
        resize: none;
        outline: none;
        line-height: 1.6;
        width: calc(100% - 4px);
        box-sizing: border-box;
        overflow-y: scroll;
        border: 1px solid;
        border-color: #000000 #ffffff #ffffff #000000;
        background-color: white;
        font-family: 'Lucida Console', Courier, monospace;
        font-size: 16px;
    }

    /* Windows XP Theme */
    .theme-winxp #editor {
        border: 2px solid #3d80f2;
        background-color: #ffffff;
        box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.1);
        font-family: 'Tahoma', 'Lucida Console', sans-serif;
    }

    /* Mac OS X Theme */
    .theme-macos #editor {
        border: 1px solid #b5b5b5;
        border-radius: 4px;
        background-color: #ffffff;
        box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
        font-family: 'Monaco', 'Menlo', monospace;
        padding: 12px;
    }

    /* iOS Theme */
    .theme-ios #editor {
        border: 1px solid #d1d1d6;
        border-radius: 8px;
        background-color: #ffffff;
        font-family: -apple-system, BlinkMacSystemFont, 'SF Mono', monospace;
        padding: 12px;
        margin: 8px;
        width: calc(100% - 18px);
        box-shadow: none;
    }

    /* Android Theme */
    .theme-android #editor {
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        background-color: #ffffff;
        font-family: 'Roboto Mono', monospace;
        padding: 12px;
        margin: 8px;
        width: calc(100% - 18px);
        box-shadow: none;
    }

    /* Dark Mode Adjustments */
    .dark-mode #editor {
        background-color: #2c2c2c;
        color: #e0e0e0;
        border-color: #555;
    }

    .dark-mode.theme-winxp #editor {
        border-color: #555;
        background-color: #1e1e1e;
    }

    .dark-mode.theme-macos #editor {
        border-color: #444;
        background-color: #1e1e1e;
    }

    .dark-mode.theme-ios #editor {
        border-color: #333;
        background-color: #000;
    }

    .dark-mode.theme-android #editor {
        border-color: #333;
        background-color: #1e1e1e;
    }

    /* Scrollbar Styling */
    #editor::-webkit-scrollbar {
        width: 12px;
    }

    #editor::-webkit-scrollbar-track {
        background: #f1f1f1;
    }

    #editor::-webkit-scrollbar-thumb {
        background: #888;
    }

    #editor::-webkit-scrollbar-thumb:hover {
        background: #555;
    }

    .dark-mode #editor::-webkit-scrollbar-track {
        background: #2c2c2c;
    }

    .dark-mode #editor::-webkit-scrollbar-thumb {
        background: #555;
    }

    .dark-mode #editor::-webkit-scrollbar-thumb:hover {
        background: #777;
    }

    /* Theme-specific scrollbars */
    .theme-win95 #editor::-webkit-scrollbar-thumb {
        background: #c0c0c0;
        border: 2px solid #000;
    }

    .theme-winxp #editor::-webkit-scrollbar-thumb {
        background: #3d80f2;
        border-radius: 6px;
    }

    .theme-macos #editor::-webkit-scrollbar {
        width: 10px;
    }

    .theme-macos #editor::-webkit-scrollbar-thumb {
        background: #c1c1c1;
        border-radius: 5px;
    }

    .theme-ios #editor::-webkit-scrollbar {
        width: 8px;
    }

    .theme-ios #editor::-webkit-scrollbar-thumb {
        background: #c7c7cc;
        border-radius: 4px;
    }

    .theme-android #editor::-webkit-scrollbar {
        width: 8px;
    }

    .theme-android #editor::-webkit-scrollbar-thumb {
        background: #dadce0;
        border-radius: 4px;
    }
    
    /* Modal Styles */
    .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.5);
        z-index: 200;
        justify-content: center;
        align-items: center;
    }
    
    .modal-content {
        background-color: #c0c0c0;
        border: 3px solid #c0c0c0;
        border-top-color: #ffffff;
        border-left-color: #ffffff;
        border-right-color: #000000;
        border-bottom-color: #000000;
        width: 90%;
        max-width: 400px;
        max-height: 80vh;
        overflow: auto;
    }
    
    .modal-title-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: linear-gradient(90deg, #000080, #1084d0);
        padding: 3px 5px;
        color: white;
        font-weight: bold;
        height: 20px;
    }
    
    .modal-body {
        padding: 15px;
    }
    
    .field-row {
        display: flex;
        justify-content: flex-end;
        gap: 8px;
        margin-top: 15px;
    }
    
    input, select, button {
        font-family: "Tahoma", sans-serif;
        font-size: 14px;
        border: 1px solid;
        border-color: #ffffff #000000 #000000 #ffffff;
        background-color: #c0c0c0;
        border-radius: 0;
        padding: 4px 8px;
    }
    
    button:active {
        border-color: #000000 #ffffff #ffffff #000000;
    }
    
    button.primary {
        background-color: #000080;
        color: white;
    }
    
    /* File Manager Styles */
    #file-manager-window {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: #c0c0c0;
        border: 3px solid #c0c0c0;
        border-top-color: #ffffff;
        border-left-color: #ffffff;
        border-right-color: #000000;
        border-bottom-color: #000000;
        z-index: 300;
        display: none;
        flex-direction: column;
    }
    
    #file-manager-content {
        display: flex;
        flex-grow: 1;
        min-height: 0;
    }
    
    #notes-list-container {
        width: 40%;
        display: flex;
        flex-direction: column;
        border-right: 1px solid #000000;
    }
    
    .notes-list-header {
        display: flex;
        padding: 4px 8px;
        font-weight: bold;
        border-bottom: 1px solid #000000;
        flex-shrink: 0;
        align-items: center;
    }
    
    .header-name {
        flex-grow: 1;
    }
    
    #note-preview-container {
        width: 60%;
        display: flex;
        flex-direction: column;
    }
    
    #note-preview-header {
        padding: 8px;
        border-bottom: 1px solid #000000;
        flex-shrink: 0;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    
    #note-preview-title {
        font-weight: bold;
        font-size: 1.2em;
    }
    
    #note-preview-date {
        font-size: 0.9em;
        opacity: 0.8;
    }
    
    #note-preview-actions {
        margin-top: 0;
        display: flex;
        gap: 8px;
    }
    
    #note-preview-actions button, #filter-btn {
        padding: 4px 10px;
        font-size: 14px;
        min-height: initial;
    }
    
    #note-preview {
        flex-grow: 1;
        padding: 10px;
        overflow-y: auto;
        white-space: pre-wrap;
        background: white;
        margin: 2px;
    }
    
    .note-item {
        display: flex;
        align-items: flex-start;
        padding: 8px;
        cursor: pointer;
        border-bottom: 1px solid #868a8e;
        gap: 8px;
    }
    
    .note-item.active {
        background-color: #000080;
        color: white;
    }
    
    .note-item .file-icon {
        width: 16px;
        height: 16px;
        flex-shrink: 0;
        margin-top: 2px;
    }
    
    .note-item-details {
        flex-grow: 1;
        display: flex;
        flex-direction: column;
    }
    
    .note-item-title {
        font-weight: bold;
    }
    
    .note-item-date {
        font-size: 0.9em;
        opacity: 0.8;
    }
    
    /* About Modal Specific Styles */
    #about-modal .modal-content {
        max-width: 500px;
    }
    
    #about-modal .modal-body {
        text-align: center;
        line-height: 1.6;
    }
    
    #about-modal p {
        margin-bottom: 15px;
    }
    
    /* Responsive Adjustments */
    @media (max-width: 768px) {
        .menu-container {
            position: static;
            margin-right: 0;
            width: 100%;
            height: auto;
            padding: 5px 0;
            background: linear-gradient(90deg, #000080, #1084d0);
        }
        
        .menu-bar {
            width: 100%;
            justify-content: center;
            flex-wrap: wrap;
            padding-left: 0;
        }
        
        .menu-item {
            padding: 5px 8px;
            font-size: 12px;
            height: auto;
        }
        
        .dropdown-content {
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            right: auto;
        }
    }

    /* Mobile-specific styles for full-width editor */
    @media (max-width: 480px) {
        #editor {
            width: 100%;
            margin: 0;
            padding: 12px;
            border: none !important;
            box-shadow: none !important;
        }
        
        .window-body {
            padding: 0;
            box-shadow: none;
        }
        
        /* Adjust theme-specific mobile styles */
        .theme-win95 #editor,
        .theme-winxp #editor,
        .theme-macos #editor,
        .theme-ios #editor,
        .theme-android #editor {
            width: 100%;
            margin: 0;
            padding: 12px;
            border: none !important;
            box-shadow: none !important;
            border-radius: 0 !important;
        }
        
        /* Dark mode adjustments */
        .dark-mode #editor {
            background-color: #1e1e1e;
        }
        
        .dark-mode.theme-ios #editor {
            background-color: #000;
        }
    }
    
    /* Windows XP Theme */
    .theme-winxp body {
        background: #D4D0C8;
    }
    
    .theme-winxp #app-window,
    .theme-winxp .modal-content,
    .theme-winxp #file-manager-window {
        background-color: #ECE9D8;
        border: 1px solid #08246B;
        box-shadow: 0 0 10px rgba(0,0,0,0.5);
        border-radius: 6px;
    }
    
    .theme-winxp .title-bar {
        background: linear-gradient(to bottom, #0058e1, #3d80f2 4%, #3d80f2 96%, #0058e1);
        padding: 3px 5px;
        color: white;
        font-weight: bold;
        height: 25px;
        border-bottom: 1px solid #08246B;
        font-size: 12px;
    }
    
    .theme-winxp .win-button {
        width: 21px;
        height: 21px;
        border: 1px solid #08246B;
        background: linear-gradient(to bottom, #6baff5, #3d83f2);
    }
    
    .theme-winxp #close-btn {
        background: linear-gradient(to bottom, #fb7c6a, #e1523b);
        border-color: #94291a;
    }
    
    /* Mac OS X Theme */
    .theme-macos body {
        background: #DCDCDC;
    }
    
    .theme-macos #app-window,
    .theme-macos .modal-content,
    .theme-macos #file-manager-window {
        background-color: #E8E8E8;
        background-image: linear-gradient(rgba(0,0,0,0.03) 50%, transparent 50%);
        background-size: 100% 4px;
        border: 1px solid #666;
        border-radius: 8px;
        box-shadow: 0 5px 25px rgba(0,0,0,0.5);
    }
    
    .theme-macos .title-bar {
        padding: 5px 10px;
        color: #333;
        font-weight: bold;
        height: 22px;
        border-bottom: 1px solid #B5B5B5;
        background: rgba(232, 232, 232, 0.8);
    }
    
    .theme-macos .win-button {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        border: 1px solid rgba(0,0,0,0.2);
    }
    
    .theme-macos #close-btn {
        background-color: #FF5F57;
        border-color: #E0443E;
    }
    
    .theme-macos #minimize-btn {
        background-color: #FEBC2E;
        border-color: #E0A123;
    }
    
    .theme-macos #maximize-btn {
        background-color: #28C840;
        border-color: #1DAD29;
    }
    
    /* iOS Theme */
    .theme-ios body {
        background: #f0f0f0;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    }
    
    .theme-ios #app-window,
    .theme-ios .modal-content,
    .theme-ios #file-manager-window {
        background-color: #ffffff;
        border: 1px solid #d1d1d6;
        border-radius: 10px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    .theme-ios .title-bar {
        background: #f7f7f7;
        padding: 10px;
        color: #000;
        font-weight: 600;
        height: auto;
        border-bottom: 1px solid #d1d1d6;
    }
    
    .theme-ios .title-bar-controls {
        display: none;
    }
    
    /* iOS Back Button */
    .theme-ios #back-button {
        display: inline-block;
        padding: 8px 12px;
        background-color: #007aff;
        color: white;
        border-radius: 4px;
        text-decoration: none;
        font-size: 14px;
        margin-right: 10px;
    }
    
    /* Android Theme */
    .theme-android body {
        background-color: #fafafa;
        font-family: 'Roboto', sans-serif;
    }
    
    .theme-android #app-window,
    .theme-android .modal-content,
    .theme-android #file-manager-window {
        background-color: #ffffff;
        border: 1px solid #e0e0e0;
        border-radius: 12px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .theme-android .title-bar {
        background: #ffffff;
        padding: 12px 16px;
        color: #202124;
        font-weight: 500;
        height: auto;
        border-bottom: 1px solid #e0e0e0;
    }
    
    .theme-android .title-bar-controls {
        display: none;
    }
    
    /* Android Back Button */
    .theme-android #back-button {
        display: inline-block;
        padding: 8px 16px;
        background-color: #f1f3f4;
        color: #202124;
        border-radius: 20px;
        text-decoration: none;
        font-size: 14px;
        margin-right: 10px;
        border: 1px solid #dadce0;
    }
    
    /* Dark Mode */
    body.dark-mode {
        background-color: #121212;
    }
    
    .dark-mode #app-window,
    .dark-mode .modal-content,
    .dark-mode #file-manager-window,
    .dark-mode .dropdown-content {
        background-color: #1e1e1e;
        color: #e0e0e0;
    }
    
    .dark-mode .title-bar {
        background: #2c2c2c;
        color: #e0e0e0;
        border-bottom-color: #3c3c3c;
    }
    
    .dark-mode .menu-bar {
        background: transparent;
    }
    
    .dark-mode .menu-item {
        color: #e0e0e0;
    }
    
    .dark-mode .menu-item:hover {
        background: rgba(255, 255, 255, 0.1);
    }
    
    .dark-mode #editor,
    .dark-mode #note-preview,
    .dark-mode input,
    .dark-mode select {
        background-color: #2c2c2c;
        color: #e0e0e0;
        border-color: #555;
    }
    
    .dark-mode .dropdown-content {
        background-color: #2c2c2c;
        border-color: #555;
    }
    
    .dark-mode .dropdown-content li {
        color: #e0e0e0;
        border-bottom-color: #3c3c3c;
    }
    
    .dark-mode .dropdown-content li:hover {
        background: #3c3c3c;
    }
    
    .dark-mode .note-item {
        border-bottom-color: #3c3c3c;
    }
    
    .dark-mode .note-item.active {
        background-color: #007aff;
        color: #fff;
    }
    
    .dark-mode .modal-body,
    .dark-mode .modal-title-bar {
        background-color: #2c2c2c;
        color: #e0e0e0;
    }
    
    .dark-mode .modal-content {
        border-color: #555;
    }
    
    /* iOS Dark Mode - Removed light borders */
    .dark-mode.theme-ios #app-window,
    .dark-mode.theme-ios .modal-content,
    .dark-mode.theme-ios #file-manager-window {
        background-color: #000;
        border-color: #333;
    }
    
    .dark-mode.theme-ios .title-bar {
        background: #1c1c1e;
        border-bottom-color: #333;
    }
    
    /* Android Dark Mode - Removed light borders */
    .dark-mode.theme-android #app-window,
    .dark-mode.theme-android .modal-content,
    .dark-mode.theme-android #file-manager-window {
        background-color: #1e1e1e;
        border-color: #333;
    }
    
    .dark-mode.theme-android .title-bar {
        background: #1e1e1e;
        border-bottom-color: #333;
    }
    
    /* Add these styles to update the menu backgrounds to match themes */
    
    /* Windows 95/98 Menu Background */
    .theme-win95 .menu-container,
    .theme-win95 .dropdown-content {
        background: linear-gradient(90deg, #000080, #1084d0);
    }
    
    /* Windows XP Menu Background */
    .theme-winxp .menu-container,
    .theme-winxp .dropdown-content {
        background: linear-gradient(to bottom, #0058e1, #3d80f2 4%, #3d80f2 96%, #0058e1);
    }
    
    /* Mac OS X Menu Background */
    .theme-macos .menu-container,
    .theme-macos .dropdown-content {
        background: rgba(232, 232, 232, 0.8);
    }
    
    /* iOS Menu Background */
    .theme-ios .menu-container,
    .theme-ios .dropdown-content {
        background: #f7f7f7;
    }
    
    /* Android Menu Background */
    .theme-android .menu-container,
    .theme-android .dropdown-content {
        background: #ffffff;
    }
    
    /* Dark Mode Updates for Saved Notes Page */
    .dark-mode #notes-list-container,
    .dark-mode .notes-list-header,
    .dark-mode #note-preview-container,
    .dark-mode #note-preview-header,
    .dark-mode #note-preview-actions,
    .dark-mode #filter-btn {
        background-color: #1e1e1e;
        color: #e0e0e0;
    }
    
    .dark-mode .notes-list-header {
        border-bottom-color: #3c3c3c;
    }
    
    .dark-mode #note-preview-header {
        border-bottom-color: #3c3c3c;
    }
    
    .dark-mode #filter-btn {
        background-color: #2c2c2c;
        border-color: #555;
        color: #e0e0e0;
    }
    
    .dark-mode #preview-open-btn,
    .dark-mode #preview-delete-btn {
        background-color: #2c2c2c;
        border-color: #555;
        color: #e0e0e0;
    }
    
    .dark-mode #preview-open-btn:hover,
    .dark-mode #preview-delete-btn:hover,
    .dark-mode #filter-btn:hover {
        background-color: #3c3c3c;
    }
    
    /* iOS Dark Mode Specific */
    .dark-mode.theme-ios .menu-container,
    .dark-mode.theme-ios .dropdown-content {
        background: #1c1c1e;
        border-color: #333;
    }
    
    /* Android Dark Mode Specific */
    .dark-mode.theme-android .menu-container,
    .dark-mode.theme-android .dropdown-content {
        background: #1e1e1e;
        border-color: #333;
    }
    
    /* Dark mode dropdown items */
    .dark-mode .dropdown-content li {
        background-color: #2c2c2c;
    }
    
    .dark-mode .dropdown-content li:hover {
        background-color: #3c3c3c;
    }
</style>
</head>
<body class="theme-win95">
    <div id="app-window">
        <div class="title-bar">
            <div class="title-bar-text">Hobopad - Untitled</div>
            
            <div class="title-bar-controls">
                <button id="minimize-btn" class="win-button" aria-label="Minimize">_</button>
                <button id="maximize-btn" class="win-button" aria-label="Maximize">â–¡</button>
                <button id="close-btn" class="win-button" aria-label="Close">Ã—</button>
            </div>
        </div>
        
<!-- Horizontal Menu Bar -->
<div class="menu-container">
    <ul class="menu-bar">
        <li class="menu-item" id="file-menu-btn">File â–¼
            <ul class="dropdown-content">
                <li id="new-file-btn">New Note</li>
                <li id="open-file-btn">Open from Device...</li>
                <li id="save-note-btn">Save Note</li>
                <li id="save-to-device-btn">Save to Device...</li>
            </ul>
        </li>
        
        <li class="menu-item" id="saved-notes-btn">Saved Notes</li>
        
        <li class="menu-item" id="styles-menu-btn">Styles â–¼
            <ul class="dropdown-content">
                <li id="theme-win95-btn">Windows 95</li>
                <li id="theme-winxp-btn">Windows XP</li>
                <li id="theme-macos-btn">Mac OS X</li>
                <li id="theme-ios-btn">iOS</li>
                <li id="theme-android-btn">Android</li>
            </ul>
        </li>
        
        <li class="menu-item" id="tools-menu-btn">Tools â–¼
            <ul class="dropdown-content">
                <li id="font-size-menu-btn">Font Size</li>
                <li id="replace-menu-btn">Replace</li>
                <li id="import-export-btn">Import/Export</li>
                <li id="dark-mode-toggle">Light Mode</li>
                <li id="about-menu-btn">About</li>
            </ul>
        </li>
    </ul>
</div>
        
        <div class="window-body">
            <textarea id="editor" spellcheck="false" placeholder="Start typing your note here..."></textarea>
        </div>
    </div>

    <!-- Modals -->
    <div id="about-modal" class="modal">
        <div class="modal-content">
            <div class="modal-title-bar">
                <div class="title-bar-text">About Hobopad</div>
                <div class="version-display">[Version 4.20.69]</div>
            </div>
            <div class="modal-body">
                <p>
                    This shitty app was vibe coded by an absolute complete dumbass who was sick of all your shitty note apps....<br><br>
                    Like who the fuck wants a note taking app to open DIRECTLY to the saved notes, showing you every single note with just enough of a snippet to raise suspicion.<br><br>
                    Get better you fucking weirdos.
                </p>
                <p>Oh and if you lose your saved notes, that's 100% on you bud, don't blame me, dumbass.</p>
                <div class="field-row">
                    <button id="close-modal-1">get fucked</button>
                    <button id="close-modal-2" class="primary">dumbass</button>
                </div>
            </div>
        </div>
    </div>

    <div id="save-note-modal" class="modal">
        <div class="modal-content">
            <div class="modal-title-bar">
                <div class="title-bar-text">Save Note</div>
            </div>
            <div class="modal-body">
                <label for="note-name-input" style="display: block; margin-bottom: 8px;">Note Name:</label>
                <input type="text" id="note-name-input" value="">
                <div class="field-row">
                    <button id="cancel-note-save-btn">Cancel</button>
                    <button id="confirm-note-save-btn" class="primary">Save</button>
                </div>
            </div>
        </div>
    </div>

    <div id="save-to-device-modal" class="modal">
        <div class="modal-content">
            <div class="modal-title-bar">
                <div class="title-bar-text">Save to Device</div>
            </div>
            <div class="modal-body">
                <label for="device-filename-input" style="display: block; margin-bottom: 8px;">File Name:</label>
                <input type="text" id="device-filename-input" value="">
                <label for="file-type-select" style="display: block; margin-top: 10px; margin-bottom: 8px;">File Type:</label>
                <select id="file-type-select">
                    <option value="txt">.txt (Text File)</option>
                    <option value="html">.html (HTML File)</option>
                </select>
                <div class="field-row">
                    <button id="cancel-device-save-btn">Cancel</button>
                    <button id="confirm-device-save-btn" class="primary">Save</button>
                </div>
            </div>
        </div>
    </div>

    <div id="font-size-modal" class="modal">
        <div class="modal-content">
            <div class="modal-title-bar">
                <div class="title-bar-text">Adjust Font Size</div>
            </div>
            <div class="modal-body">
                <input type="range" id="font-size-slider" min="8" max="48" value="16">
                <p id="font-size-display">16px</p>
                <div class="field-row">
                    <button id="close-font-modal-btn">Close</button>
                </div>
            </div>
        </div>
    </div>

    <div id="replace-modal" class="modal">
        <div class="modal-content">
            <div class="modal-title-bar">
                <div class="title-bar-text">Replace</div>
            </div>
            <div class="modal-body">
                <label for="find-input">Find:</label>
                <input type="text" id="find-input">
                <label for="replace-input" style="margin-top: 10px;">Replace with:</label>
                <input type="text" id="replace-input">
                <div class="field-row">
                    <button id="confirm-replace-all-btn">Replace All</button>
                    <button id="close-replace-btn">Close</button>
                </div>
            </div>
        </div>
    </div>

    <div id="import-export-modal" class="modal">
        <div class="modal-content">
            <div class="modal-title-bar">
                <div class="title-bar-text">Import/Export Notes</div>
            </div>
            <div class="modal-body">
                <div style="display: flex; justify-content: space-around;">
                    <div style="text-align: center;">
                        <button id="import-notes-btn">ðŸ“¥</button>
                        <p>Import Notes</p>
                    </div>
                    <div style="text-align: center;">
                        <button id="export-notes-btn">ðŸ“¤</button>
                        <p>Export Notes</p>
                    </div>
                </div>
                <p style="text-align: center; margin-top: 15px; color: #888; font-size: 0.8em;">
                    any lost notes are 100% your own fault for trusting this shit.
                </p>
                <div class="field-row">
                    <button id="close-io-modal-btn">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Hidden file inputs -->
    <input type="file" id="file-opener" accept=".txt,text/plain" style="display: none;">
    <input type="file" id="import-file-opener" accept=".json,application/json" style="display: none;">

    <!-- File Manager Window -->
    <div id="file-manager-window">
        <div class="title-bar">
            <div class="title-bar-text">Saved Notes</div>
            <div class="title-bar-controls">
                <button id="file-manager-close-btn" class="win-button" aria-label="Close">Ã—</button>
            </div>
        </div>
        <div class="window-body">
            <div id="file-manager-content">
                <div id="notes-list-container">
                    <div class="notes-list-header">
                        <span class="header-name">Name</span>
                        <div class="menu-item">
                            <button id="filter-btn">Filter</button>
                            <ul class="dropdown-content">
                                <li data-sort="name-asc">Name (A-Z)</li>
                                <li data-sort="name-desc">Name (Z-A)</li>
                                <li data-sort="date-desc">Newest First</li>
                                <li data-sort="date-asc">Oldest First</li>
                            </ul>
                        </div>
                    </div>
                    <div id="notes-list"></div>
                </div>
                <div id="note-preview-container">
                    <div id="note-preview-header">
                        <div>
                            <div id="note-preview-title"></div>
                            <div id="note-preview-date"></div>
                        </div>
                        <div id="note-preview-actions">
                            <button id="preview-open-btn">Open in Editor</button>
                            <button id="preview-delete-btn">Delete</button>
                        </div>
                    </div>
                    <div id="note-preview">Select a note to preview...</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // DOM element references
            const getEl = id => document.getElementById(id);
            const editor = getEl('editor');
            const titleBarText = document.querySelector('.title-bar-text');
            
            // State variables
            let currentNoteId = null;
            let isDirty = false;
            let autosaveTimeout = null;
            let selectedPreviewId = null;
            
            // Menu toggle functionality
            const menuButtons = ['file-menu-btn', 'styles-menu-btn', 'tools-menu-btn'];
            
            menuButtons.forEach(buttonId => {
                const button = getEl(buttonId);
                button.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const dropdown = button.querySelector('.dropdown-content');
                    const isVisible = dropdown.style.display === 'block';
                    
                    // Close all dropdowns first
                    document.querySelectorAll('.dropdown-content').forEach(d => {
                        d.style.display = 'none';
                    });
                    
                    // Toggle this dropdown if it wasn't already visible
                    if (!isVisible) {
                        dropdown.style.display = 'block';
                    }
                });
            });
            
            // Close dropdowns when clicking elsewhere
            document.addEventListener('click', () => {
                document.querySelectorAll('.dropdown-content').forEach(d => {
                    d.style.display = 'none';
                });
            });
            
            // Theme management
            const setTheme = (theme) => {
                const isDark = document.body.classList.contains('dark-mode');
                document.body.className = isDark ? `dark-mode ${theme}` : theme;
                localStorage.setItem('hobopad_theme', theme);
            };
            
            // Dark mode toggle
            const setDarkMode = (isDark) => {
                if (isDark) {
                    document.body.classList.add('dark-mode');
                    getEl('dark-mode-toggle').textContent = 'Dark Mode';
                    localStorage.setItem('hobopad_darkmode', 'enabled');
                } else {
                    document.body.classList.remove('dark-mode');
                    getEl('dark-mode-toggle').textContent = 'Light Mode';
                    localStorage.setItem('hobopad_darkmode', 'disabled');
                }
            };
            
            // Initialize theme and dark mode
            const savedTheme = localStorage.getItem('hobopad_theme') || 'theme-win95';
            const savedDarkMode = localStorage.getItem('hobopad_darkmode');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            
            setTheme(savedTheme);
            setDarkMode(savedDarkMode === 'enabled' || (savedDarkMode === null && prefersDark));
            
            // Title bar updates
            const updateTitleBar = (noteName, showSavedMessage = false) => {
                const baseTitle = `${noteName || 'Untitled'} - Hobopad`;
                titleBarText.textContent = baseTitle;
                
                if (showSavedMessage) {
                    titleBarText.textContent = `âœ“ Saved - ${noteName || 'Untitled'} - Hobopad`;
                    setTimeout(() => {
                        if (titleBarText.textContent.startsWith('âœ“ Saved')) {
                            titleBarText.textContent = baseTitle;
                        }
                    }, 1500);
                }
            };
            
            // Note management
            const saveNoteToLocalStorage = (name, isAutosave = false) => {
                let notes = JSON.parse(localStorage.getItem('hobopad_notes') || '[]');
                let noteName = name.trim() || 'Untitled';
                let savedNoteName = noteName;
                
                if (currentNoteId) {
                    const note = notes.find(n => n.id === currentNoteId);
                    if (note) {
                        note.content = editor.value;
                        note.createdAt = Date.now();
                        note.name = noteName;
                        savedNoteName = note.name;
                    }
                } else {
                    const note = { 
                        id: Date.now(), 
                        name: noteName, 
                        content: editor.value, 
                        createdAt: Date.now() 
                    };
                    notes.unshift(note);
                    currentNoteId = note.id;
                    savedNoteName = note.name;
                }
                
                localStorage.setItem('hobopad_notes', JSON.stringify(notes));
                isDirty = false;
                
                if (isAutosave) {
                    updateTitleBar(savedNoteName, true);
                } else {
                    updateTitleBar(savedNoteName);
                }
            };
            
            // File operations
            const saveToDevice = (filename, type) => {
                const content = editor.value;
                const blob = new Blob([content], { type: type === 'html' ? 'text/html' : 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `${filename.trim() || 'Untitled'}.${type}`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            };
            
            // Replace functionality
            const replaceAll = (findTerm, replaceTerm) => {
                if (!findTerm) return false;
                
                const text = editor.value;
                const escapedTerm = findTerm.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&');
                const pattern = escapedTerm.length === 1 ? `\\b${escapedTerm}\\b` : escapedTerm;
                const regex = new RegExp(pattern, 'gi');
                
                if (text.match(regex)) {
                    editor.value = text.replace(regex, replaceTerm);
                    return true;
                }
                return false;
            };
            
            // File manager
            const renderNotes = (sortOrder = 'date-desc') => {
                let notes = JSON.parse(localStorage.getItem('hobopad_notes') || '[]');
                
                switch(sortOrder) {
                    case 'name-asc': notes.sort((a, b) => a.name.localeCompare(b.name)); break;
                    case 'name-desc': notes.sort((a, b) => b.name.localeCompare(a.name)); break;
                    case 'date-asc': notes.sort((a, b) => a.createdAt - b.createdAt); break;
                    case 'date-desc': notes.sort((a, b) => b.createdAt - a.createdAt); break;
                }
                
                const notesList = getEl('notes-list');
                notesList.innerHTML = '';
                
                notes.forEach(note => {
                    const item = document.createElement('div');
                    item.className = 'note-item';
                    item.dataset.noteId = note.id;
                    item.innerHTML = `
                        <svg class="file-icon" viewBox="0 0 16 16" width="16" height="16" fill="currentColor">
                            <path d="M4 0h8l4 4v12H0V0h4zm8 2H2v12h12V4.5L12 2zM5 8h6v1H5V8zm0 2h6v1H5v-1zm0 2h4v1H5v-1z"/>
                        </svg>
                        <div class="note-item-details">
                            <span class="note-item-title">${note.name}</span>
                            <span class="note-item-date">${new Date(note.createdAt).toLocaleString()}</span>
                        </div>
                    `;
                    notesList.appendChild(item);
                });
            };
            
            // Event listeners
            getEl('close-btn').addEventListener('click', () => {
                if (isDirty && !confirm('You have unsaved changes. Close anyway?')) {
                    return;
                }
                window.close();
            });
            
            getEl('new-file-btn').addEventListener('click', () => {
                if (isDirty && !confirm('You have unsaved changes. Create new note anyway?')) {
                    return;
                }
                
                editor.value = '';
                currentNoteId = null;
                isDirty = false;
                updateTitleBar('Untitled');
            });
            
            getEl('save-note-btn').addEventListener('click', () => {
                if (currentNoteId) {
                    saveNoteToLocalStorage();
                    alert('Note updated!');
                } else {
                    getEl('save-note-modal').style.display = 'flex';
                    getEl('note-name-input').focus();
                }
            });
            
            getEl('confirm-note-save-btn').addEventListener('click', () => {
                saveNoteToLocalStorage(getEl('note-name-input').value);
                getEl('save-note-modal').style.display = 'none';
            });
            
            getEl('cancel-note-save-btn').addEventListener('click', () => {
                getEl('save-note-modal').style.display = 'none';
            });
            
            getEl('save-to-device-btn').addEventListener('click', () => {
                getEl('save-to-device-modal').style.display = 'flex';
                getEl('device-filename-input').focus();
            });
            
            getEl('confirm-device-save-btn').addEventListener('click', () => {
                const filename = getEl('device-filename-input').value;
                const type = getEl('file-type-select').value;
                saveToDevice(filename, type);
                getEl('save-to-device-modal').style.display = 'none';
            });
            
            getEl('cancel-device-save-btn').addEventListener('click', () => {
                getEl('save-to-device-modal').style.display = 'none';
            });
            
            getEl('open-file-btn').addEventListener('click', () => {
                getEl('file-opener').click();
            });
            
            getEl('file-opener').addEventListener('change', event => {
                const file = event.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = e => {
                    editor.value = e.target.result;
                    currentNoteId = null;
                    isDirty = false;
                    updateTitleBar(file.name.replace(/\.[^/.]+$/, ""));
                };
                reader.readAsText(file);
                event.target.value = null;
            });
            
            // Theme switchers
            getEl('theme-win95-btn').addEventListener('click', () => {
                setTheme('theme-win95');
                document.querySelectorAll('.dropdown-content').forEach(d => {
                    d.style.display = 'none';
                });
            });
            
            getEl('theme-winxp-btn').addEventListener('click', () => {
                setTheme('theme-winxp');
                document.querySelectorAll('.dropdown-content').forEach(d => {
                    d.style.display = 'none';
                });
            });
            
            getEl('theme-macos-btn').addEventListener('click', () => {
                setTheme('theme-macos');
                document.querySelectorAll('.dropdown-content').forEach(d => {
                    d.style.display = 'none';
                });
            });
            
            getEl('theme-ios-btn').addEventListener('click', () => {
                setTheme('theme-ios');
                document.querySelectorAll('.dropdown-content').forEach(d => {
                    d.style.display = 'none';
                });
            });
            
            getEl('theme-android-btn').addEventListener('click', () => {
                setTheme('theme-android');
                document.querySelectorAll('.dropdown-content').forEach(d => {
                    d.style.display = 'none';
                });
            });
            
            // Dark mode toggle
            getEl('dark-mode-toggle').addEventListener('click', () => {
                setDarkMode(!document.body.classList.contains('dark-mode'));
                document.querySelectorAll('.dropdown-content').forEach(d => {
                    d.style.display = 'none';
                });
            });
            
            // Font size control
            getEl('font-size-menu-btn').addEventListener('click', () => {
                const currentSize = parseInt(editor.style.fontSize) || 16;
                getEl('font-size-slider').value = currentSize;
                getEl('font-size-display').textContent = `${currentSize}px`;
                getEl('font-size-modal').style.display = 'flex';
                document.querySelectorAll('.dropdown-content').forEach(d => {
                    d.style.display = 'none';
                });
            });
            
            getEl('font-size-slider').addEventListener('input', e => {
                editor.style.fontSize = `${e.target.value}px`;
                getEl('font-size-display').textContent = `${e.target.value}px`;
            });
            
            getEl('close-font-modal-btn').addEventListener('click', () => {
                getEl('font-size-modal').style.display = 'none';
            });
            
            // Replace functionality
            getEl('replace-menu-btn').addEventListener('click', () => {
                getEl('replace-modal').style.display = 'flex';
                getEl('find-input').focus();
                document.querySelectorAll('.dropdown-content').forEach(d => {
                    d.style.display = 'none';
                });
            });
            
            getEl('close-replace-btn').addEventListener('click', () => {
                getEl('replace-modal').style.display = 'none';
            });
            
            getEl('confirm-replace-all-btn').addEventListener('click', () => {
                const findTerm = getEl('find-input').value;
                const replaceTerm = getEl('replace-input').value;
                
                if (!findTerm) {
                    alert("Please enter text to find.");
                    return;
                }
                
                if (replaceAll(findTerm, replaceTerm)) {
                    alert("All occurrences have been replaced.");
                } else {
                    alert("Text not found.");
                }
            });
            
            // Import/Export
            getEl('import-export-btn').addEventListener('click', () => {
                getEl('import-export-modal').style.display = 'flex';
                document.querySelectorAll('.dropdown-content').forEach(d => {
                    d.style.display = 'none';
                });
            });
            
            getEl('close-io-modal-btn').addEventListener('click', () => {
                getEl('import-export-modal').style.display = 'none';
            });
            
            getEl('export-notes-btn').addEventListener('click', () => {
                const notes = localStorage.getItem('hobopad_notes');
                if (!notes || notes === '[]') {
                    alert("No notes to export.");
                    return;
                }
                
                const now = new Date();
                const timestamp = `${now.getFullYear()}${(now.getMonth()+1).toString().padStart(2,'0')}${now.getDate().toString().padStart(2,'0')}_${now.getHours().toString().padStart(2,'0')}${now.getMinutes().toString().padStart(2,'0')}${now.getSeconds().toString().padStart(2,'0')}`;
                const filename = `hobopad_notes_${timestamp}.json`;
                
                const blob = new Blob([notes], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            });
            
            getEl('import-notes-btn').addEventListener('click', () => {
                getEl('import-file-opener').click();
            });
            
            getEl('import-file-opener').addEventListener('change', (event) => {
                const file = event.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const importedNotes = JSON.parse(e.target.result);
                        if (!Array.isArray(importedNotes)) {
                            throw new Error("Invalid JSON file: Not an array.");
                        }
                        
                        const existingNotes = JSON.parse(localStorage.getItem('hobopad_notes') || '[]');
                        const combinedNotes = [...existingNotes];
                        const existingIds = new Set(existingNotes.map(n => n.id));
                        let importCount = 0;
                        
                        importedNotes.forEach(note => {
                            if (note.id && note.name && note.content && note.createdAt && !existingIds.has(note.id)) {
                                combinedNotes.push(note);
                                importCount++;
                            }
                        });
                        
                        localStorage.setItem('hobopad_notes', JSON.stringify(combinedNotes));
                        alert(`${importCount} notes imported successfully.`);
                        getEl('import-export-modal').style.display = 'none';
                    } catch (err) {
                        alert(`Error importing notes: ${err.message}`);
                    }
                };
                reader.readAsText(file);
                event.target.value = null;
            });
            
            // File manager
            getEl('saved-notes-btn').addEventListener('click', () => {
                renderNotes();
                getEl('note-preview-title').textContent = '';
                getEl('note-preview-date').textContent = '';
                getEl('note-preview').textContent = 'Select a note to preview...';
                getEl('file-manager-window').style.display = 'flex';
                
                // Add back button for iOS/Android themes
                const theme = document.body.className.split(' ')[0];
                if (theme === 'theme-ios' || theme === 'theme-android') {
                    const backButton = document.createElement('a');
                    backButton.id = 'back-button';
                    backButton.textContent = 'Back';
                    backButton.href = '#';
                    backButton.addEventListener('click', (e) => {
                        e.preventDefault();
                        closeFileManager();
                    });
                    
                    const titleBar = document.querySelector('#file-manager-window .title-bar');
                    if (titleBar && !document.getElementById('back-button')) {
                        titleBar.insertBefore(backButton, titleBar.firstChild);
                    }
                }
            });
            
            const closeFileManager = () => {
                getEl('file-manager-window').style.display = 'none';
            };
            
            getEl('file-manager-close-btn').addEventListener('click', closeFileManager);
            
            getEl('notes-list').addEventListener('click', e => {
                const noteItem = e.target.closest('.note-item');
                if (!noteItem) return;
                
                const notes = JSON.parse(localStorage.getItem('hobopad_notes') || '[]');
                const noteId = Number(noteItem.dataset.noteId);
                const note = notes.find(n => n.id === noteId);
                
                document.querySelectorAll('.note-item').forEach(item => item.classList.remove('active'));
                noteItem.classList.add('active');
                
                getEl('note-preview-title').textContent = note.name;
                getEl('note-preview-date').textContent = new Date(note.createdAt).toLocaleString();
                getEl('note-preview').textContent = note.content;
                selectedPreviewId = note.id;
            });
            
            getEl('preview-open-btn').addEventListener('click', () => {
                if (!selectedPreviewId) return;
                
                const notes = JSON.parse(localStorage.getItem('hobopad_notes') || '[]');
                const note = notes.find(n => n.id === selectedPreviewId);
                
                editor.value = note.content;
                currentNoteId = note.id;
                isDirty = false;
                updateTitleBar(note.name);
                closeFileManager();
            });
            
            getEl('preview-delete-btn').addEventListener('click', () => {
                if (!selectedPreviewId) return;
                
                if (!confirm('Are you sure you want to delete this note?')) return;
                
                const notes = JSON.parse(localStorage.getItem('hobopad_notes') || '[]');
                const remainingNotes = notes.filter(n => n.id !== selectedPreviewId);
                
                localStorage.setItem('hobopad_notes', JSON.stringify(remainingNotes));
                renderNotes();
                
                getEl('note-preview-title').textContent = '';
                getEl('note-preview-date').textContent = '';
                getEl('note-preview').textContent = 'Select a note to preview...';
                selectedPreviewId = null;
            });
            
            getEl('filter-btn').parentElement.addEventListener('click', e => {
                if (e.target.dataset.sort) {
                    renderNotes(e.target.dataset.sort);
                }
            });
            
            // About modal
            getEl('about-menu-btn').addEventListener('click', () => {
                getEl('about-modal').style.display = 'flex';
                document.querySelectorAll('.dropdown-content').forEach(d => {
                    d.style.display = 'none';
                });
            });
            
            getEl('close-modal-1').addEventListener('click', () => {
                getEl('about-modal').style.display = 'none';
            });
            
            getEl('close-modal-2').addEventListener('click', () => {
                getEl('about-modal').style.display = 'none';
            });
            
            // Autosave and dirty tracking
            editor.addEventListener('input', () => {
                isDirty = true;
                clearTimeout(autosaveTimeout);
                
                if (currentNoteId) {
                    autosaveTimeout = setTimeout(() => {
                        const notes = JSON.parse(localStorage.getItem('hobopad_notes') || '[]');
                        const note = notes.find(n => n.id === currentNoteId);
                        if (note) {
                            saveNoteToLocalStorage(note.name, true);
                        }
                    }, 1500);
                }
            });
            
            // Warn before closing with unsaved changes
            window.addEventListener('beforeunload', (e) => {
                if (isDirty) {
                    e.preventDefault();
                    e.returnValue = '';
                }
            });
            
            // Initialize
            updateTitleBar('Untitled');
            
            // Service worker registration
            if ('serviceWorker' in navigator) {
                window.addEventListener('load', () => {
                    navigator.serviceWorker.register('/sw.js').catch(err => {
                        console.error('ServiceWorker registration failed: ', err);
                    });
                });
            }
        });
    </script>
</body>
</html>
